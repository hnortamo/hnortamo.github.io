<!DOCTYPE html>
<html>
<head>
  <title>Leaflet Quick Start Guide Example</title>
  <meta charset="utf-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!--   <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
  -->
   <link rel="stylesheet" href="/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
   <style>

        @media (min-width: 1200px) {
            .image {
              width: 500px
            }
        }
        @media (min-width: 992px) and (max-width: 1199px) {
            .image {
              width: 500px
            }
        }
        @media (min-width: 768px) and (max-width: 991px) {
            .image {
              width: 500px
            }
        }
        @media (max-width: 767px) {
            .image {
              width: 300px
            }
        }
</style>

</head>
<body>
  <div id="map" style="width: 1920px; height: 1500px"></div>

 <!-- <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
 -->
  <script src="/leaflet.js"></script>
  <script>
	   var map = L.map('map').setView([51.505, 60], 5);
     L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 19,
    attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
}).addTo(map);

//	   fetch('http://localhost:8000/custom.geo.json')
//	   fetch('/europe-asia-large.json')
//  .then(response => {
//    if (!response.ok) {
//      throw new Error('Network response was not ok');
//    }
//    return response.json();
//  })
//  .then(data => {
//	var lander = data.features
//	  for (let i = 0; i < lander.length; i++) {
//		L.geoJSON(lander[i]).addTo(map)
//	  }
//    // Process the JSON data here
//    console.log(data.features);
//    // ... further logic using the data
//  })
//  .catch(error => {
//    console.error('There has been a problem with your fetch operation:', error);
//  });




//	  for (let i = 0; i < supercomputers.features.length; i++) {
//		coord = supercomputers.features[i].geometry.coordinates
//		  L.marker([coord[1],coord[0]]).addTo(map);
	//	L.marker([49.84,18.25]).addTo(map);

	 // }

	   fetch('/places.json')
  .then(response => {
    if (!response.ok) {
      throw new Error('Network response was not ok');
    }
    return response.json();
  })
  .then(travellocations => {
	  for (let i = 0; i < travellocations.features.length-1; i++) {
	   startPoint=[travellocations.features[i].geometry.coordinates[1],travellocations.features[i].geometry.coordinates[0]];
	   endPoint=[travellocations.features[i+1].geometry.coordinates[1],travellocations.features[i+1].geometry.coordinates[0]];
	   var polyline = L.polyline([startPoint, endPoint],
  //     { color: "red",
  //  weight: 2,
  //  smoothFactor: 1}
{color: 'black', weight: '3',  dashArray: '20, 20', dashOffset: '0'}
     ).addTo(map);
	  }
	  for (let i = 0; i < travellocations.features.length; i++) {
		coord = travellocations.features[i].geometry.coordinates
		  name = travellocations.features[i].properties.name
		  L.circleMarker([coord[1],coord[0]],
			{ color: 'red',
        		fillColor: '#f03',}
      ).bindPopup("<b>"+name+"</b><br><img src="+travellocations.features[i].properties.imagelink+" width=500px%>",{
  maxWidth: "auto"
}).addTo(map);

	  }

  })
  .catch(error => {
    console.error('There has been a problem with your fetch operation:', error);
  });

      const queryString = window.location.search;
     const urlParams = new URLSearchParams(queryString);
     if (urlParams.has('lat')){
      const lat = urlParams.get('lat')
      const lon = urlParams.get('long')
      map.flyTo([lat,lon],15)
     }




  </script>
</body>
</html>